# .ebextensions/01_npm.config
commands:
  01_set_npm_proxy:
    command: |
      npm config set proxy http://proxy-url:port
      npm config set https-proxy http://proxy-url:port
    ignoreErrors: true

  02_upgrade_npm:
    command: npm install -g npm@latest
    test: "test $(npm -v | cut -d. -f1) -lt 7"

container_commands:
  01_npm_install:
    command: |
      echo "Starting npm install..."
      for i in {1..3}; do
        npm install && break || echo "Attempt $i failed, retrying..."
      done
    leader_only: false
    ignoreErrors: false
